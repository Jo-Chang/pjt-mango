{% extends 'base.html' %}


{% block title %} 25 & 27s {% endblock title %}


{% block content %}
<header>
  {% if store.latitude and store.longitude %}
    <div id="map" style="height:400px;" class="container-fluid"></div>
  {% else %}
    <p class="text-secondary fst-italic">No Location Information</p>
  {% endif %}
  
  <div id="carouselExample" class="carousel slide">
    <div class="carousel-inner">
      <div class="carousel-item active">
        첫 이미지
      </div>
      {% for store in stores %}
      <div class="carousel-item">
        <div class="d-block w-100">
          {{ store.image }}
        </div>  
      </div>
      {% endfor %}
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>
</header>
<main>
  <div class="container-fluid">
    <div class="row">
      <div class="col">
        <p>{{ store.name }} {{store.rating_avg}}</p>
        <span>조회수, 리뷰수, 즐겨찾기 수</span>
        <hr>
        <p>{{ store.address }}</p>
        <p>{{ store.phonenumber }}</p>
        <p>{{ store.category }}</p>
        <p>{{ store.price }}</p>
        <p>{{ store.starttime }}</p>
        <p>{{ store.endtime }}</p>
        <p>{{ store.menu }}</p>
        <p>{{ store.content }}</p>
        <p id="lat" style="display: none">{{ store.latitude }}</p>
        <p id="lng" style="display: none">{{ store.longitude }}</p>
      </div>
      <div class="col">
        네이버지도
        관련 인기 식당
      </div>
    </div>
  </div>
  <div class="container-fluid">
    <hr>
{% comment %} 
    <div class="container-fluid">
      <span>리뷰: ({{ 리뷰전부 }})</span>
      <a href="">전체 ({{ 리뷰전부 }})</a>
      <a href="">맛있다 ({{ 맛있다 리뷰 }})</a>
      <a href="">괜찮다 ({{ 괜찮다 전부 }})</a>
      <a href="">별로 ({{ 별로 전부 }})</a>
    </div>
     {% endcomment %}
    <hr>
    <div class="container-fluid">
      {% for review in reviews  %}
      <div class="row">
        <div class="col">
          <div class="container-fluid">
            <span>{{ user.image }}</span>
            <p>{{ review.nickname }} </p>
          </div>
        </div>
        <div class="col">
          <div class="container-fluid">
            <p>review.created_at</p>
            <p>review.content</p>
            <div class="container-fluid">
              {{ review.image }}
            </div>
          </div>
        </div>
        <div class="col">
          {{ review.emote }}
        </div>
      </div>
      <hr>
      {% endfor %}
    </div>
  </div>
  <div class="container">
    인덱스처럼 다른 식당 리스트 불러오기
  </div>
</main>

{% endblock content %}


{% block script %}
{# APIKEY 숨기기는 React 권장 #}
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=afbeb49e64cb240112a667970ea3d85f"></script>
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=afbeb49e64cb240112a667970ea3d85f&libraries=services,clusterer,drawing"></script>
<script>
  const mapLat = document.getElementById('lat').textContent
  const mapLng = document.getElementById('lng').textContent

  if (mapLat !== 'None' && mapLng !== 'None') {
    const mapPosition = new kakao.maps.LatLng(mapLat, mapLng)
  
    console.log(mapLat, mapLng)
  
    var mapContainer = document.getElementById('map')
    var mapOption = {
      center: mapPosition,
      level: 3
    }
  
    var map = new kakao.maps.Map(mapContainer, mapOption)
  
    var markerPosition = mapPosition
  
    var marker = new kakao.maps.Marker({
      position: markerPosition
    })
  
    marker.setMap(map)
  }
</script>
{% endblock script %}